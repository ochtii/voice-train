<!DOCTYPE html>
<html lang="en" data-theme="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Device Management - Voice Recognition System</title>
    <link rel="stylesheet" href="/static/css/main.css">
    <link rel="stylesheet" href="/static/css/devices.css">
    <script src="/static/js/devices.js" defer></script>
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar">
        <div class="nav-container">
            <a href="/" class="nav-brand">
                <svg class="nav-icon" viewBox="0 0 24 24" fill="currentColor">
                    <path d="M12 1L9 4H6C4.9 4 4 4.9 4 6V18C4 19.1 4.9 20 6 20H18C19.1 20 20 19.1 20 18V6C20 4.9 19.1 4 18 4H15L12 1ZM12 9C13.66 9 15 10.34 15 12S13.66 15 12 15 9 13.66 9 12 10.34 9 12 9Z"/>
                </svg>
                <div>
                    <div class="nav-title">Voice Recognition</div>
                    <div class="nav-subtitle">Device Management</div>
                </div>
            </a>

            <div class="nav-menu">
                <a href="/dashboard" class="nav-link">
                    <svg viewBox="0 0 24 24" fill="currentColor">
                        <path d="M3 13H11V3H3V13ZM3 21H11V15H3V21ZM13 21H21V11H13V21ZM13 3V9H21V3H13Z"/>
                    </svg>
                    Dashboard
                </a>
                <a href="/enrollment" class="nav-link">
                    <svg viewBox="0 0 24 24" fill="currentColor">
                        <path d="M12 2C13.1 2 14 2.9 14 4C14 5.1 13.1 6 12 6C10.9 6 10 5.1 10 4C10 2.9 10.9 2 12 2ZM21 9V7L15 7.5V9.5C15 10.8 16.2 12 17.5 12S20 10.8 20 9.5H21ZM3 13C5.33 13 7.31 14.14 8.54 15.86L12 13L15.46 15.86C16.69 14.14 18.67 13 21 13V11C17.13 11 14 14.13 14 18V22H10V18C10 14.13 6.87 11 3 11V13Z"/>
                    </svg>
                    Speaker Enrollment
                </a>
                <a href="/devices" class="nav-link active">
                    <svg viewBox="0 0 24 24" fill="currentColor">
                        <path d="M4 6H20V16H4M20 18A2 2 0 0 0 22 16V6C22 4.89 21.1 4 20 4H4A2 2 0 0 0 2 6V16A2 2 0 0 0 4 18H0V20H24V18H20Z"/>
                    </svg>
                    Devices
                </a>
                <a href="/settings" class="nav-link">
                    <svg viewBox="0 0 24 24" fill="currentColor">
                        <path d="M12,15.5A3.5,3.5 0 0,1 8.5,12A3.5,3.5 0 0,1 12,8.5A3.5,3.5 0 0,1 15.5,12A3.5,3.5 0 0,1 12,15.5M19.43,12.97C19.47,12.65 19.5,12.33 19.5,12C19.5,11.67 19.47,11.34 19.43,11L21.54,9.37C21.73,9.22 21.78,8.95 21.66,8.73L19.66,5.27C19.54,5.05 19.27,4.96 19.05,5.05L16.56,6.05C16.04,5.66 15.5,5.32 14.87,5.07L14.5,2.42C14.46,2.18 14.25,2 14,2H10C9.75,2 9.54,2.18 9.5,2.42L9.13,5.07C8.5,5.32 7.96,5.66 7.44,6.05L4.95,5.05C4.73,4.96 4.46,5.05 4.34,5.27L2.34,8.73C2.22,8.95 2.27,9.22 2.46,9.37L4.57,11C4.53,11.34 4.5,11.67 4.5,12C4.5,12.33 4.53,12.65 4.57,12.97L2.46,14.63C2.27,14.78 2.22,15.05 2.34,15.27L4.34,18.73C4.46,18.95 4.73,19.03 4.95,18.95L7.44,17.94C7.96,18.34 8.5,18.68 9.13,18.93L9.5,21.58C9.54,21.82 9.75,22 10,22H14C14.25,22 14.46,21.82 14.5,21.58L14.87,18.93C15.5,18.68 16.04,18.34 16.56,17.94L19.05,18.95C19.27,19.03 19.54,18.95 19.66,18.73L21.66,15.27C21.78,15.05 21.73,14.78 21.54,14.63L19.43,12.97Z"/>
                    </svg>
                    Settings
                </a>
            </div>

            <div class="nav-actions">
                <div class="connection-status" id="connectionStatus">
                    <div class="status-indicator" id="statusIndicator"></div>
                    <span id="statusText">Connecting...</span>
                </div>
                <button class="theme-toggle" id="themeToggle" aria-label="Toggle theme">
                    <svg class="theme-icon-light" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M12,8A4,4 0 0,0 8,12A4,4 0 0,0 12,16A4,4 0 0,0 16,12A4,4 0 0,0 12,8M12,18A6,6 0 0,1 6,12A6,6 0 0,1 12,6A6,6 0 0,1 18,12A6,6 0 0,1 12,18M20,8.69V4H15.31L12,0.69L8.69,4H4V8.69L0.69,12L4,15.31V20H8.69L12,23.31L15.31,20H20V15.31L23.31,12L20,8.69Z"/>
                    </svg>
                    <svg class="theme-icon-dark" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M17.75,4.09L15.22,6.03L16.13,9.09L13.5,7.28L10.87,9.09L11.78,6.03L9.25,4.09L12.44,4L13.5,1L14.56,4L17.75,4.09M21.25,11L19.61,12.25L20.2,14.23L18.5,13.06L16.8,14.23L17.39,12.25L15.75,11L17.81,10.95L18.5,9L19.19,10.95L21.25,11M18.97,15.95C19.8,15.87 20.69,17.05 20.16,17.8C19.84,18.25 19.5,18.67 19.08,19.07C15.17,23 8.84,23 4.94,19.07C1.03,15.17 1.03,8.83 4.94,4.93C5.34,4.53 5.76,4.17 6.21,3.85C6.96,3.32 8.14,4.21 8.06,5.04C7.79,7.9 8.75,10.87 10.95,13.06C13.14,15.26 16.1,16.22 18.97,15.95M17.33,17.97C14.5,17.81 11.7,16.64 9.53,14.5C7.36,12.31 6.2,9.5 6.04,6.68C3.23,9.82 3.34,14.4 6.35,17.41C9.37,20.43 14,20.54 17.33,17.97Z"/>
                    </svg>
                </button>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="main-content">
        <div class="container">
            <!-- Page Header -->
            <div class="page-header">
                <div class="header-info">
                    <h1>Device Management</h1>
                    <p>Manage audio input and output devices</p>
                </div>
                <div class="header-actions">
                    <button class="btn btn-primary" id="refreshDevicesBtn">
                        <svg viewBox="0 0 24 24" fill="currentColor">
                            <path d="M17.65,6.35C16.2,4.9 14.21,4 12,4A8,8 0 0,0 4,12A8,8 0 0,0 12,20C15.73,20 18.84,17.45 19.73,14H17.65C16.83,16.33 14.61,18 12,18A6,6 0 0,1 6,12A6,6 0 0,1 12,6C13.66,6 15.14,6.69 16.22,7.78L13,11H20V4L17.65,6.35Z"/>
                        </svg>
                        Refresh Devices
                    </button>
                    <button class="btn btn-secondary" id="testAudioBtn">
                        <svg viewBox="0 0 24 24" fill="currentColor">
                            <path d="M14,3.23V5.29C16.89,6.15 19,8.83 19,12C19,15.17 16.89,17.85 14,18.71V20.77C18,19.86 21,16.28 21,12C21,7.72 18,4.14 14,3.23M16.5,12C16.5,10.23 15.5,8.71 14,7.97V16C15.5,15.29 16.5,13.76 16.5,12Z"/>
                        </svg>
                        Test Audio
                    </button>
                </div>
            </div>

            <!-- Device Overview Cards -->
            <div class="devices-overview">
                <div class="card">
                    <div class="card-header">
                        <div class="card-title">
                            <svg viewBox="0 0 24 24" fill="currentColor">
                                <path d="M12,2A3,3 0 0,1 15,5V11A3,3 0 0,1 12,14A3,3 0 0,1 9,11V5A3,3 0 0,1 12,2M19,11C19,14.53 16.39,17.44 13,17.93V21H11V17.93C7.61,17.44 5,14.53 5,11H7A5,5 0 0,0 12,16A5,5 0 0,0 17,11H19Z"/>
                            </svg>
                            Input Devices
                        </div>
                        <div class="device-count" id="inputDeviceCount">-</div>
                    </div>
                    <div class="card-content">
                        <div class="device-status">
                            <div class="status-item">
                                <span class="status-label">Active:</span>
                                <span class="status-value" id="activeInputDevice">None</span>
                            </div>
                            <div class="status-item">
                                <span class="status-label">Sample Rate:</span>
                                <span class="status-value" id="inputSampleRate">-</span>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <div class="card-title">
                            <svg viewBox="0 0 24 24" fill="currentColor">
                                <path d="M14,3.23V5.29C16.89,6.15 19,8.83 19,12C19,15.17 16.89,17.85 14,18.71V20.77C18,19.86 21,16.28 21,12C21,7.72 18,4.14 14,3.23M16.5,12C16.5,10.23 15.5,8.71 14,7.97V16C15.5,15.29 16.5,13.76 16.5,12Z"/>
                            </svg>
                            Output Devices
                        </div>
                        <div class="device-count" id="outputDeviceCount">-</div>
                    </div>
                    <div class="card-content">
                        <div class="device-status">
                            <div class="status-item">
                                <span class="status-label">Active:</span>
                                <span class="status-value" id="activeOutputDevice">None</span>
                            </div>
                            <div class="status-item">
                                <span class="status-label">Volume:</span>
                                <span class="status-value" id="outputVolume">-</span>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <div class="card-title">
                            <svg viewBox="0 0 24 24" fill="currentColor">
                                <path d="M12,2A10,10 0 0,1 22,12A10,10 0 0,1 12,22A10,10 0 0,1 2,12A10,10 0 0,1 12,2M12,4A8,8 0 0,0 4,12A8,8 0 0,0 12,20A8,8 0 0,0 20,12A8,8 0 0,0 12,4M11,16.5L6.5,12L7.91,10.59L11,13.67L16.59,8.09L18,9.5L11,16.5Z"/>
                            </svg>
                            System Status
                        </div>
                        <div class="status-indicator" id="systemStatusIndicator"></div>
                    </div>
                    <div class="card-content">
                        <div class="device-status">
                            <div class="status-item">
                                <span class="status-label">Audio API:</span>
                                <span class="status-value" id="audioAPI">-</span>
                            </div>
                            <div class="status-item">
                                <span class="status-label">Latency:</span>
                                <span class="status-value" id="audioLatency">-</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Device Lists -->
            <div class="devices-grid">
                <!-- Input Devices -->
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">Input Devices (Microphones)</h3>
                        <button class="btn btn-secondary btn-small" id="addInputDeviceBtn">
                            <svg viewBox="0 0 24 24" fill="currentColor">
                                <path d="M19,13H13V19H11V13H5V11H11V5H13V11H19V13Z"/>
                            </svg>
                            Add Device
                        </button>
                    </div>
                    <div class="card-content">
                        <div class="device-list" id="inputDeviceList">
                            <!-- Input devices will be populated by JavaScript -->
                        </div>
                    </div>
                </div>

                <!-- Output Devices -->
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">Output Devices (Speakers)</h3>
                        <button class="btn btn-secondary btn-small" id="addOutputDeviceBtn">
                            <svg viewBox="0 0 24 24" fill="currentColor">
                                <path d="M19,13H13V19H11V13H5V11H11V5H13V11H19V13Z"/>
                            </svg>
                            Add Device
                        </button>
                    </div>
                    <div class="card-content">
                        <div class="device-list" id="outputDeviceList">
                            <!-- Output devices will be populated by JavaScript -->
                        </div>
                    </div>
                </div>
            </div>

            <!-- Audio Testing Section -->
            <div class="card">
                <div class="card-header">
                    <h3 class="card-title">Audio Testing</h3>
                </div>
                <div class="card-content">
                    <div class="audio-testing">
                        <div class="test-section">
                            <h4>Input Test (Recording)</h4>
                            <div class="test-controls">
                                <button class="btn btn-primary" id="startRecordingTestBtn">
                                    <svg viewBox="0 0 24 24" fill="currentColor">
                                        <path d="M12,2A3,3 0 0,1 15,5V11A3,3 0 0,1 12,14A3,3 0 0,1 9,11V5A3,3 0 0,1 12,2Z"/>
                                    </svg>
                                    Start Recording Test
                                </button>
                                <button class="btn btn-secondary" id="playRecordingTestBtn" disabled>
                                    <svg viewBox="0 0 24 24" fill="currentColor">
                                        <path d="M8,5.14V19.14L19,12.14L8,5.14Z"/>
                                    </svg>
                                    Play Recording
                                </button>
                                <div class="test-timer" id="recordingTestTimer">00:00</div>
                            </div>
                            <div class="audio-level-meter">
                                <div class="level-bar">
                                    <div class="level-fill" id="inputLevelFill"></div>
                                </div>
                                <div class="level-labels">
                                    <span>Quiet</span>
                                    <span>Good</span>
                                    <span>Loud</span>
                                </div>
                            </div>
                        </div>

                        <div class="test-section">
                            <h4>Output Test (Playback)</h4>
                            <div class="test-controls">
                                <button class="btn btn-primary" id="playTestToneBtn">
                                    <svg viewBox="0 0 24 24" fill="currentColor">
                                        <path d="M8,5.14V19.14L19,12.14L8,5.14Z"/>
                                    </svg>
                                    Play Test Tone
                                </button>
                                <select class="form-select" id="testToneSelect">
                                    <option value="440">440 Hz (A4)</option>
                                    <option value="880">880 Hz (A5)</option>
                                    <option value="1000">1000 Hz</option>
                                    <option value="white">White Noise</option>
                                    <option value="pink">Pink Noise</option>
                                </select>
                                <div class="volume-control">
                                    <label for="testVolumeSlider">Volume:</label>
                                    <input type="range" id="testVolumeSlider" min="0" max="100" value="50" class="volume-slider">
                                    <span id="testVolumeValue">50%</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Device Configuration Modal -->
    <div class="modal" id="deviceConfigModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title" id="deviceConfigModalTitle">Device Configuration</h3>
                <button class="modal-close" id="closeDeviceConfigModal">
                    <svg viewBox="0 0 24 24" fill="currentColor">
                        <path d="M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12L19,6.41Z"/>
                    </svg>
                </button>
            </div>
            <div class="modal-body">
                <form id="deviceConfigForm">
                    <div class="form-group">
                        <label for="deviceName" class="form-label">Device Name</label>
                        <input type="text" id="deviceName" class="form-input" readonly>
                    </div>
                    <div class="form-group">
                        <label for="deviceAlias" class="form-label">Alias (Optional)</label>
                        <input type="text" id="deviceAlias" class="form-input" placeholder="Enter custom name">
                    </div>
                    <div class="form-group">
                        <label for="deviceSampleRate" class="form-label">Sample Rate</label>
                        <select id="deviceSampleRate" class="form-select">
                            <option value="8000">8000 Hz</option>
                            <option value="16000">16000 Hz</option>
                            <option value="22050">22050 Hz</option>
                            <option value="44100">44100 Hz</option>
                            <option value="48000">48000 Hz</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="deviceChannels" class="form-label">Channels</label>
                        <select id="deviceChannels" class="form-select">
                            <option value="1">Mono (1)</option>
                            <option value="2">Stereo (2)</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="checkbox-label">
                            <input type="checkbox" id="deviceDefault" class="checkbox">
                            Set as default device
                        </label>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" id="cancelDeviceConfig">Cancel</button>
                <button type="button" class="btn btn-primary" id="saveDeviceConfig">Save Configuration</button>
            </div>
        </div>
    </div>

    <!-- Toast Container -->
    <div class="toast-container" id="toastContainer"></div>

    <!-- Global Scripts -->
    <script src="/static/js/theme.js"></script>
    <script src="/static/js/notifications.js"></script>
</body>
</html>